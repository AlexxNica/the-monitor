<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml" lang="ja">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Monitoring 101: Alerting on what matters &mdash; the monitor 0.1 ドキュメント</title>
    
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/translations.js"></script>
    <link rel="top" title="the monitor 0.1 ドキュメント" href="../index.html" />
    <link rel="up" title="基本編" href="index.html" />
    <link rel="next" title="Monitoring 101: Collecting the right data" href="monitoring_101_collecting_the_right_data..html" />
    <link rel="prev" title="基本編" href="index.html" />
   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="monitoring-101-alerting-on-what-matters">
<span id="monitoring-101-alerting-on-what-matters"></span><h1>Monitoring 101: Alerting on what matters<a class="headerlink" href="#monitoring-101-alerting-on-what-matters" title="このヘッドラインへのパーマリンク">¶</a></h1>
<p><em>This post is part of a series on effective monitoring. Be
sure to check out the rest of the series: <a class="reference external" href="/blog/monitoring-101-collecting-data/">Collecting the right data</a> and <a class="reference external" href="/blog/monitoring-101-investigation/">Investigating performance issues</a>.</em></p>
<p>Automated alerts are essential to monitoring. They allow you to spot
problems anywhere in your infrastructure, so that you can rapidly
identify their causes and minimize service degradation and disruption.</p>
<p>But alerts aren’t always as effective as they could be. In particular,
real problems are often lost in a sea of noisy alarms. This article
describes a simple approach to effective alerting, regardless of the
scale of the systems involved. In short:</p>
<ol class="simple">
<li>Alert liberally; page judiciously</li>
<li>Page on symptoms, rather than causes</li>
</ol>
<p>This series of articles comes out of our experience monitoring
large-scale infrastructure for <a class="reference external" href="https://www.datadoghq.com/customers/">our
customers</a>. It also draws on the
work of <a class="reference external" href="http://dtdg.co/use-method">Brendan Gregg</a>, <a class="reference external" href="http://dtdg.co/philosophy-alerting">Rob
Ewaschuk</a>, and <a class="reference external" href="http://dtdg.co/metrics-attention">Baron
Schwartz</a>.</p>
<div class="section" id="when-to-alert-someone-or-no-one">
<span id="when-to-alert-someone-or-no-one"></span><h2>When to alert someone (or no one)<a class="headerlink" href="#when-to-alert-someone-or-no-one" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p><img alt="" src="https://d33tyra1llx9zy.cloudfront.net/blog/images/2015-05-how-to-monitor/alerting101_2_chart.png" /></p>
<p>An alert should communicate something specific about your systems in
plain language: “Two Cassandra nodes are down” or “90% of all web
requests are taking more than 0.5s to process and respond.” Automating
alerts across as many of your systems as possible allows you to respond
quickly to issues and provide better service, and it also saves time by
freeing you from continual manual inspection of metrics.</p>
<div class="section" id="levels-of-alerting-urgency">
<span id="levels-of-alerting-urgency"></span><h3>Levels of alerting urgency<a class="headerlink" href="#levels-of-alerting-urgency" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>Not all alerts carry the same degree of urgency. Some require immediate
human intervention, some require eventual human intervention, and some
point to areas where attention may be needed in the future. All alerts
should, at a minimum, be logged to a central location for easy
correlation with other metrics and events.</p>
<div class="section" id="alerts-as-records-low-severity">
<span id="alerts-as-records-low-severity"></span><h4>Alerts as records (low severity)<a class="headerlink" href="#alerts-as-records-low-severity" title="このヘッドラインへのパーマリンク">¶</a></h4>
<p>Many alerts will not be associated with a service problem, so a human
may never even need to be aware of them. For instance, when a data store
that supports a user-facing service starts serving queries much slower
than usual, but not slow enough to make an appreciable difference in the
overall service’s response time, that should generate a low-urgency
alert that is recorded in your monitoring system for future reference or
investigation but does not interrupt anyone’s work. After all, transient
issues that could be to blame, such as network congestion, often go away
on their own. But should a significant issue develop—say, if the service
starts returning a large number of timeouts—that alert-based data will
provide invaluable context for your investigation.</p>
</div>
<div class="section" id="alerts-as-notifications-moderate-severity">
<span id="alerts-as-notifications-moderate-severity"></span><h4>Alerts as notifications (moderate severity)<a class="headerlink" href="#alerts-as-notifications-moderate-severity" title="このヘッドラインへのパーマリンク">¶</a></h4>
<p>The next tier of alerting urgency is for issues that do require
intervention, but not right away. Perhaps the data store is running low
on disk space and should be scaled out in the next several days. Sending
an email and/or posting a notification in the service owner’s chat room
is a perfect way to deliver these alerts—both message types are highly
visible, but they won’t wake anyone in the middle of the night or
disrupt an engineer’s flow.</p>
</div>
<div class="section" id="alerts-as-pages-high-severity">
<span id="alerts-as-pages-high-severity"></span><h4>Alerts as pages (high severity)<a class="headerlink" href="#alerts-as-pages-high-severity" title="このヘッドラインへのパーマリンク">¶</a></h4>
<p>The most urgent alerts should receive special treatment and be escalated
to a page (as in “<a class="reference external" href="https://en.wikipedia.org/wiki/Pager">pager</a>”) to
urgently request human attention. Response times for your web
application, for instance, should have an internal SLA that is at least
as aggressive as your strictest customer-facing SLA. Any instance of
response times exceeding your internal SLA would warrant immediate
attention, whatever the hour.</p>
<p><img alt="" src="https://d33tyra1llx9zy.cloudfront.net/blog/images/2015-05-how-to-monitor/alerting101_2_band_1.png" /></p>
</div>
</div>
<div class="section" id="when-to-let-a-sleeping-engineer-lie">
<span id="when-to-let-a-sleeping-engineer-lie"></span><h3>When to let a sleeping engineer lie<a class="headerlink" href="#when-to-let-a-sleeping-engineer-lie" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>Whenever you consider setting an alert, ask yourself three questions to
determine the alert’s level of urgency and how it should be handled:</p>
<ol>
<li><p class="first"><strong>Is this issue real?</strong> It may seem obvious, but if the issue is not
real, it usually should not generate an alert. The examples below
can trigger alerts but probably are not symptomatic of real
problems. Alerting—or, worse, paging—on occurrences such as these
contributes to alert fatigue and can cause more serious issues to be
ignored:</p>
<ul class="simple">
<li>Metrics in a test environment are out of bounds</li>
<li>A single server is doing its work very slowly, but it is part of
a cluster with fast-failover to other machines, and it reboots
periodically anyway</li>
<li>Planned upgrades are causing large numbers of machines to report
as offline</li>
</ul>
<p>If the issue is indeed <strong>real</strong>, it should generate an alert. Even
if the alert is not linked to a notification, it should be recorded
within your monitoring system for later analysis and correlation.</p>
</li>
<li><p class="first"><strong>Does this issue require attention?</strong> If you can reasonably
automate a response to an issue, you should consider doing so. There
is a very real cost to calling someone away from work, sleep, or
personal time. If the issue is <strong>real <em>and</em> it requires attention</strong>,
it should generate an alert that notifies someone who can
investigate and fix the problem. At minimum, the notification should
be sent via email, chat or a ticketing system so that the recipients
can prioritize their response.</p>
</li>
<li><p class="first"><strong>Is this issue urgent?</strong> Not all issues are emergencies. For
example, perhaps a moderately higher than normal percentage of
system responses have been very slow, or perhaps a slightly elevated
share of queries are returning stale data. Both issues may need to
be addressed soon, but not at 4:00 A.M. If, on the other hand, a key
system stops doing its work at an acceptable rate, an engineer
should take a look immediately. If the symptom is <strong>real <em>and</em> it
requires attention <em>and</em> it is urgent</strong>, it should generate a page.</p>
</li>
</ol>
<p><img alt="" src="https://d33tyra1llx9zy.cloudfront.net/blog/images/2015-05-how-to-monitor/alerting101_2_band_2.png" /></p>
</div>
<div class="section" id="page-on-symptoms">
<span id="page-on-symptoms"></span><h3>Page on symptoms<a class="headerlink" href="#page-on-symptoms" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>Pages deserve special mention: they are extremely effective for
delivering information, but they can be quite disruptive if overused, or
if they are linked to poorly designed alerts. In general, a page is the
most appropriate kind of alert when the system you are responsible for
stops doing useful work with acceptable throughput, latency, or error
rates. Those are the sort of problems that you want to know about
immediately.</p>
<p>The fact that your system stopped doing useful work is a <em>symptom</em>—that
is, it is a manifestation of an issue that may have any number of
different <em>causes</em>. For example: if your website has been responding
very slowly for the last three minutes, that is a symptom. Possible
causes include high database latency, failed application servers,
Memcached being down, high load, and so on. Whenever possible, build
your pages around symptoms rather than causes. See our <a class="reference external" href="https://www.datadoghq.com/blog/2015/06/monitoring-101-collecting-data/">companion article
on data collection</a> for a metric framework that helps to separate
symptoms from causes.</p>
<p>Paging on symptoms surfaces real, oftentimes user-facing problems,
rather than hypothetical or internal problems. Contrast paging on a
symptom, such as slow website responses, with paging on potential causes
of the symptom, such as high load on your web servers. Your users will
not know or care about server load if the website is still responding
quickly, and your engineers will resent being bothered for something
that is only internally noticeable and that may revert to normal levels
without intervention.</p>
<div class="section" id="durable-alert-definitions">
<span id="durable-alert-definitions"></span><h4>Durable alert definitions<a class="headerlink" href="#durable-alert-definitions" title="このヘッドラインへのパーマリンク">¶</a></h4>
<p>Another good reason to page on symptoms is that symptom-triggered alerts
tend to be durable. This means that regardless of how underlying system
architectures may change, if the system stops doing work as well as it
should, you will get an appropriate page even without updating your
alert definitions.</p>
<p><img alt="" src="https://d33tyra1llx9zy.cloudfront.net/blog/images/2015-05-how-to-monitor/alerting101_2_band_3.png" /></p>
</div>
<div class="section" id="exception-to-the-rule-early-warning-signs">
<span id="exception-to-the-rule-early-warning-signs"></span><h4>Exception to the rule: Early warning signs<a class="headerlink" href="#exception-to-the-rule-early-warning-signs" title="このヘッドラインへのパーマリンク">¶</a></h4>
<p>It is sometimes necessary to call human attention to a small handful of
metrics even when the system is performing adequately. Early warning
metrics reflect an unacceptably high probability that serious symptoms
will soon develop and require immediate intervention.</p>
<p>Disk space is a classic example. Unlike running out of free memory or
CPU, when you run out of disk space, the system will not likely recover,
and you probably will have only a few seconds before your system hard
stops. Of course, if you can notify someone with plenty of lead time,
then there is no need to wake anyone in the middle of the night. Better
yet, you can anticipate some situations when disk space will run low and
build automated remediation based on the data you can afford to erase,
such as logs or data that exists somewhere else.</p>
</div>
</div>
</div>
<div class="section" id="conclusion-get-serious-about-symptoms">
<span id="conclusion-get-serious-about-symptoms"></span><h2>Conclusion: Get serious about symptoms<a class="headerlink" href="#conclusion-get-serious-about-symptoms" title="このヘッドラインへのパーマリンク">¶</a></h2>
<ul class="simple">
<li>Send a page only when symptoms of urgent problems in your system’s
work are detected, or if a critical and finite resource limit is
about to be reached.</li>
<li>Set up your monitoring system to record alerts whenever it detects
real issues in your infrastructure, even if those issues have not
yet affected overall performance.</li>
</ul>
<p>We would like to hear about your experiences as you apply this framework
to your own monitoring practice. If it is working well, please <a class="reference external" href="https://twitter.com/datadoghq">let us
know on Twitter</a>! Questions, corrections,
additions, complaints, etc? Please <a class="reference external" href="https://github.com/DataDog/the-monitor">let us know on
GitHub</a>.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">目次</a></h3>
  <ul>
<li><a class="reference internal" href="#">Monitoring 101: Alerting on what matters</a><ul>
<li><a class="reference internal" href="#when-to-alert-someone-or-no-one">When to alert someone (or no one)</a><ul>
<li><a class="reference internal" href="#levels-of-alerting-urgency">Levels of alerting urgency</a><ul>
<li><a class="reference internal" href="#alerts-as-records-low-severity">Alerts as records (low severity)</a></li>
<li><a class="reference internal" href="#alerts-as-notifications-moderate-severity">Alerts as notifications (moderate severity)</a></li>
<li><a class="reference internal" href="#alerts-as-pages-high-severity">Alerts as pages (high severity)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#when-to-let-a-sleeping-engineer-lie">When to let a sleeping engineer lie</a></li>
<li><a class="reference internal" href="#page-on-symptoms">Page on symptoms</a><ul>
<li><a class="reference internal" href="#durable-alert-definitions">Durable alert definitions</a></li>
<li><a class="reference internal" href="#exception-to-the-rule-early-warning-signs">Exception to the rule: Early warning signs</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#conclusion-get-serious-about-symptoms">Conclusion: Get serious about symptoms</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">基本編</a><ul>
      <li>Previous: <a href="index.html" title="前の章へ">基本編</a></li>
      <li>Next: <a href="monitoring_101_collecting_the_right_data..html" title="次の章へ">Monitoring 101: Collecting the right data</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>このページ</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/monitoring-101/monitoring_101_alerting_on_what_matters..txt"
            rel="nofollow">ソースコードを表示</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>クイック検索</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="検索" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2016, Datadog.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.4.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.7</a>
      
      |
      <a href="../_sources/monitoring-101/monitoring_101_alerting_on_what_matters..txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>